---
import { themeConfig } from "@/config";
---

<a
  href="/blog"
  class="back-button w-32 inline-flex items-center gap-[0.375rem] font-serif text-[length:var(--font-size-m)] italic tracking-wide leading-[1.75] text-[var(--muted-foreground)] cursor-pointer border-none bg-transparent relative mb-[2.5em] p-0 -left-[0.175em] transition-colors duration-200 no-underline hover:text-[var(--foreground)]"
>
  <svg
    width="16"
    height="16"
    viewBox="0 0 16 16"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
    class="w-[0.8rem] h-[0.8rem] shrink-0"
  >
    <path
      d="M2.5 6.5H9.5C11.1569 6.5 12.5 7.84315 12.5 9.5V9.5C12.5 11.1569 11.1569 12.5 9.5 12.5H7.5M2.5 6.5L5.5 9.5M2.5 6.5L5.5 3.5"
      stroke="currentColor"
      stroke-width="1.25"
      stroke-linecap="round"
      stroke-linejoin="round"></path>
  </svg>
  Posts
</a>

<script
  is:inline
  define:vars={{
    toc: themeConfig.post.toc,
  }}
>
  const adjustBackButtonPosition = () => {
    const button = document.querySelector(".back-button");
    if (!button) {
      return;
    }

    const contentWidth = "35rem";
    const centeredLayout = true;

    if (!centeredLayout) {
      button.classList.remove("fixed-position");
      button.style.left = "";
      return;
    }

    const pageWidth = window.innerWidth;
    const contentWidthValue = Number.parseFloat(contentWidth);
    const widthValue = Math.min(contentWidthValue, 50);
    const shouldUseCustomWidth = widthValue > 25;
    const finalWidthValue = shouldUseCustomWidth ? widthValue : 25;
    const margin = (pageWidth - finalWidthValue * 16) / 2;
    const baseMinSpace = 11 * 16;
    const minSpace = toc ? baseMinSpace + 52 : baseMinSpace + 12;

    if (margin >= minSpace) {
      button.classList.add("fixed-position");
      const basePosition = margin - baseMinSpace;
      const leftPosition = toc ? basePosition - 40 : basePosition;
      button.style.left = `${leftPosition}px`;
    } else {
      button.classList.remove("fixed-position");
      button.style.left = "";
    }
  };

  adjustBackButtonPosition();

  document.addEventListener("astro:page-load", adjustBackButtonPosition);
  window.addEventListener("resize", adjustBackButtonPosition);
</script>

<style>
  @media (hover: none) and (pointer: coarse) {
    .back-button:hover {
      color: var(--muted-foreground);
    }
  }

  .back-button.fixed-position {
    position: fixed;
    top: 6rem;
    margin-bottom: 0;
    padding-left: 0.75rem;
    z-index: 10;
  }
</style>
